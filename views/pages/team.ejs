<% include ../partials/header %>
<div class="blankslate">
	<h1>Mon équipe</h1>
	
	<% if (user.team == undefined) { %>
		<div class="flash flash-error">Votre équipe n'a pas encore été créée !</div>
		<form action="/monequipe/creer" method="POST">
			<dl class="form">
				<dt><label for="name">Nom : </label></dt>
				<dd><input type="text" name="name" class="input-large" placeholder="Nom de l'équipe" /></dd>
			</dl>
			<button class="btn" type="submit">Créer</button>
		</form>
	
	<% } else { %>
		<% if ( error != undefined && error != '' ) { %>
		<div class="flash flash-error">
			<% if (error == 'not-enough-money') { %>
			Vous n'avez pas assez d'argent pour acheter ce joueur !
			<% } else { %>
				<%= error %>
			<% } %>
		</div>
		<% } %>
		
		<h2>Nom</h2>
		<%= userTeam.name %>

		<h2>Argent restant</h2>
		<%= userTeam.getCurrentMoney() %> €

		<h2>Liste des joueurs</h2>
		<table id="team-list" class="display" width="100%"></table>
		<script type="text/javascript">
			var dataSet = [
				<% playerList.forEach(function(player){ %>
					[	'<%= player.firstname %>',
						'<%= player.lastname %>',
						'<%= player.position %>',
						'<%= player.club %>',
						'<%= player.initValue %>€',
						'<%= player.currentValue %>€',
						'<%= player.date %>',
						'<span style="color: <% if ( player.valueDifference > 0 ){ %>green<% } else { %>red<% } %>"><%= player.valueDifference %>€</span>',
						'<form action="/monequipe/vendrejoueur" method="POST">\
						<input type="hidden" name="playerId" value="<%= player.id %>" />\
						<button class="btn" type="submit">Vendre pour <%= player.sellingValue %>€</button>\
						</form>'
					],
				<% }) %>
			];
			$(document).ready(function() {
				$('#team-list').DataTable( {
					data: dataSet,
					columns: [
						{ title: "Prénom" },
						{ title: "Nom" },
						{ title: "Position" },
						{ title: "Club" },
						{ title: "Valeur d'achat" },
						{ title: "Valeur actuelle" },
						{ title: "Date d'achat" },
						{ title: "Variation" },
						{ title: "Action" },
					]
				} );
			} );
		</script>
	
		<h3>Gardien</h3>
		<a href="/monequipe/acheter/Gardien">Acheter un gardien</a>.
	
		<h3>Défenseur</h3>
		<a href="/monequipe/acheter/Défenseur">Acheter un défenseur</a>.
	
		<h3>Milieu de terrain</h3>
		<a href="/monequipe/acheter/Milieu">Acheter un milieu de terrain</a>.
	
		<h3>Attaquant</h3>
		<a href="/monequipe/acheter/Attaquant">Acheter un attaquant</a>.
		
	<% } %>
</div>
<% include ../partials/footer %>